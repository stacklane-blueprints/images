<!--TEMPLATE mustache-->
<!doctype html>
<html lang="en">

<head>
    <title>{{ðŸŽ¨.title}}</title>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.5/css/bulma.min.css" integrity="sha256-vK3UTo/8wHbaUn+dTQD0X6dzidqc5l7gczvH+Bnowwk=" crossorigin="anonymous">

    <link rel="stylesheet" href="/style.scss">

    <script defer src="https://cdn.jsdelivr.net/npm/stimulus@1.1.1/dist/stimulus.umd.js" integrity="sha256-mUuPeK7DRsoSOwJJcvbcMgWsqAVPJs7X8K/h7NxXQj4=" crossorigin="anonymous"></script>

    {{! Client-side rotation based on EXIF }}
    <script defer async src="https://cdn.jsdelivr.net/npm/blueimp-load-image@2.21.0/js/load-image.all.min.js" integrity="sha256-mtKZhQBI3ewHPDzk2TBlA2ykWkBOxMtbq11Vg3bKVPc=" crossorigin="anonymous"></script>

    <script defer src="/js/init.js"></script>
    <script defer src="/js/image.js"></script>
    <script defer src="/js/modal.js"></script>
    <script defer src="/js/notification.js"></script>

    {{% import {Post} from 'ðŸ“¦' }}
    {{% svg /_icons/ as ic }}
    {{% partial /_dialog as dialog }}
</head>

<body>

{{! Toolbar }}
<nav class="navbar is-info" role="navigation" aria-label="main navigation">
    <div class="container">
        <div class="navbar-brand">
            <span class="navbar-item">
                <b>{{ðŸŽ¨.title}}</b>
            </span>
            <div class="navbar-item">
                <div class="buttons">
                    <a href="#" class="button is-primary" data-controller="modal" data-action="modal#show" data-modal-id="addDialog">
                        <span class="icon is-small">{{> ic-add_image}}</span>
                        <span><strong>{{ðŸŽ¨.action-add}}</strong></span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>

{{! Include Dialog }}
{{> dialog}}

{{! Main Content }}
<main class="container">
    {{! Messages }}
    {{% choose-string-map message error=is-danger *=is-* }}
    {{#Messages.all}}
    <div data-controller="notification" class="notification {{% choose-string message this.type }}">
        <button class="delete"></button>
        {{this.value}}
    </div>
    {{/Messages.all}}

    {{! Listing }}
    <div class="columns is-multiline is-mobile">
        {{#Post.all as post}}
        <div class="column is-one-quarter">
            <div class="card {{#post.image.unsafe}}is-unsafe{{/post.image.unsafe}}">
                <header class="card-header">
                    <p class="card-header-title">
                        {{post.title}}
                    </p>
                </header>
                <div class="card-image">
                    <figure class="image">
                        {{{post.image}}}
                    </figure>
                </div>
                <footer class="card-footer">
                    {{#post.copyable}}
                    <span class="card-footer-item">
                        <form action="/posts/{{post.id}}/copy" method="POST">
                            <input value="{{ðŸŽ¨.action-copy}}" type="submit" class="button is-small">
                        </form>
                    </span>
                    {{/post.copyable}}
                    <span class="card-footer-item">
                        <form action="/posts/{{post.id}}/delete" method="POST">
                            <input value="{{ðŸŽ¨.action-delete}}" type="submit" class="button is-small">
                        </form>
                    </span>
                </footer>
            </div>
        </div>
        {{/Post.all}}
    </div>

    {{! Empty Case }}
    {{^Post.all}}
    <section class="hero is-light">
        <div class="hero-body">
            <div class="container">
                <p class="title">
                    {{ðŸŽ¨.empty-title}}
                </p>
                <p class="subtitle">
                    {{ðŸŽ¨.empty-desc ðŸŽ¨.action-add}}
                </p>
            </div>
        </div>
    </section>
    {{/Post.all}}
</main>

</body>

</html>

